<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jenko — Chess</title>
<style>
  body {
    margin:0;
    background:#0a0a0a;
    color:#00ff66;
    font-family: "Source Code Pro", monospace;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    height:100vh;
  }

:root { --cell-size: 60px; }

.board {
  grid-template-columns: repeat(8, var(--cell-size));
  grid-template-rows: repeat(8, var(--cell-size));
}

@media (max-width: 600px) {
  :root { --cell-size: min(11vw, 48px); }
  .cell { font-size: calc(var(--cell-size) * 0.6); }
}

  .cell {
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:36px;
    cursor:pointer;
    user-select:none;
  }

  .cell.white { background:#002200; }
  .cell.black { background:#003300; }

  .piece.white { color:#00ff66; } /* outline white pieces */
  .piece.black { color:#00ff66; } /* filled black pieces */

  .selected {
    outline:2px solid #03fc88;
  }

  .highlight {
    box-shadow: inset 0 0 0 3px #03fc88;
  }

  .button {
    color:#0a0a0a;
    background:#00ff66;
    padding:8px 16px;
    font-family:"Source Code Pro", monospace;
    font-size:16px;
    border:none;
    cursor:pointer;
    border-radius:4px;
  }
</style>
</head>
<body>

<div class="board" id="board"></div>
<button class="button" onclick="goBack()">Return to Main Site</button>

<script>
const board = document.getElementById("board");

const initialBoard = [
  ["bR","bN","bB","bQ","bK","bB","bN","bR"],
  ["bP","bP","bP","bP","bP","bP","bP","bP"],
  ["","","","","","","",""],
  ["","","","","","","",""],
  ["","","","","","","",""],
  ["","","","","","","",""],
  ["wP","wP","wP","wP","wP","wP","wP","wP"],
  ["wR","wN","wB","wQ","wK","wB","wN","wR"]
];

let cells = [];
let selected = null;
let validMoves = [];
let turn = "w"; // white starts

const symbols = {
  "wK":"♔","wQ":"♕","wR":"♖","wB":"♗","wN":"♘","wP":"♙",
  "bK":"♚","bQ":"♛","bR":"♜","bB":"♝","bN":"♞","bP":"♟"
};

// Build board
for(let r=0;r<8;r++){
  for(let c=0;c<8;c++){
    const cell = document.createElement("div");
    cell.classList.add("cell");
    cell.classList.add((r+c)%2===0?"white":"black");
    cell.dataset.row = r;
    cell.dataset.col = c;
    board.appendChild(cell);
    cells.push(cell);

    cell.addEventListener("click",()=>handleClick(r,c));
  }
}

let boardState = JSON.parse(JSON.stringify(initialBoard));
render();

function render(){
  for(let r=0;r<8;r++){
    for(let c=0;c<8;c++){
      const cell = cells[r*8+c];
      cell.innerHTML = "";
      const piece = boardState[r][c];
      cell.classList.remove("selected","highlight");
      if(piece){
        const el = document.createElement("span");
        el.textContent = symbols[piece];
        el.classList.add("piece");
        el.classList.add(piece[0]==="w"?"white":"black");
        cell.appendChild(el);
      }
    }
  }

  if(selected){
    cells[selected.row*8+selected.col].classList.add("selected");
    validMoves.forEach(m=>{
      cells[m.row*8+m.col].classList.add("highlight");
    });
  }
}

function handleClick(r,c){
  const piece = boardState[r][c];
  if(selected){
    // If click on valid move
    if(validMoves.some(m=>m.row===r && m.col===c)){
      const target = boardState[r][c];
      boardState[r][c] = boardState[selected.row][selected.col];
      boardState[selected.row][selected.col] = "";
      if(target && target[1]==="K"){
        alert(turn==="w"?"White wins!":"Black wins!");
        boardState = JSON.parse(JSON.stringify(initialBoard));
        turn = "w";
      } else {
        turn = turn==="w"?"b":"w";
      }
    }
    selected = null;
    validMoves = [];
    render();
  } else if(piece && piece[0]===turn){
    selected = {row:r,col:c};
    validMoves = getValidMoves(r,c);
    render();
  }
}

function getValidMoves(sr,sc){
  const moves = [];
  for(let r=0;r<8;r++){
    for(let c=0;c<8;c++){
      if(validMove(sr,sc,r,c)){
        moves.push({row:r,col:c});
      }
    }
  }
  return moves;
}

function validMove(sr,sc,er,ec){
  const piece = boardState[sr][sc];
  const target = boardState[er][ec];
  const dr = er-sr;
  const dc = ec-sc;

  if(target && target[0]===piece[0]) return false;

  switch(piece[1]){
    case "P":
      if(piece[0]==="w"){
        if(dc===0 && dr===-1 && !target) return true;
        if(dc===0 && dr===-2 && sr===6 && !target && !boardState[sr-1][sc]) return true;
        if(Math.abs(dc)===1 && dr===-1 && target && target[0]==="b") return true;
      } else {
        if(dc===0 && dr===1 && !target) return true;
        if(dc===0 && dr===2 && sr===1 && !target && !boardState[sr+1][sc]) return true;
        if(Math.abs(dc)===1 && dr===1 && target && target[0]==="w") return true;
      }
      break;
    case "R":
      if(dr===0 || dc===0) return clearPath(sr,sc,er,ec);
      break;
    case "B":
      if(Math.abs(dr)===Math.abs(dc)) return clearPath(sr,sc,er,ec);
      break;
    case "Q":
      if(dr===0 || dc===0 || Math.abs(dr)===Math.abs(dc)) return clearPath(sr,sc,er,ec);
      break;
    case "N":
      if((Math.abs(dr)===2 && Math.abs(dc)===1)||(Math.abs(dr)===1 && Math.abs(dc)===2)) return true;
      break;
    case "K":
      if(Math.abs(dr)<=1 && Math.abs(dc)<=1) return true;
      break;
  }
  return false;
}

function clearPath(sr,sc,er,ec){
  const dr = Math.sign(er-sr);
  const dc = Math.sign(ec-sc);
  let r = sr+dr;
  let c = sc+dc;
  while(r!==er || c!==ec){
    if(boardState[r][c]) return false;
    r+=dr;
    c+=dc;
  }
  return true;
}

function goBack(){
  window.location.href = "index.html";
}
</script>

</body>
</html>

